<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Google Sheets 公開資料讀取示範</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
    }
    th {
      background: #eee;
    }
  </style>
</head>
<body>
  <h1>Google Sheets 公開資料顯示</h1>
  <table id="data-table"></table>

  <!-- 載入 Tabletop.js -->
  <script src="https://cdn.jsdelivr.net/npm/tabletop@1.6.0/tabletop.min.js"></script>
  <script>
    window.onload = function() {
      const publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1z1Pvo8OlwJs2NBrwg1LBnF61aN_QSU2d5o53ykqFt90/pubhtml';

      function showInfo(data, tabletop) {
        const table = document.getElementById('data-table');
        if (!data || data.length === 0) {
          table.innerHTML = '<tr><td>無資料</td></tr>';
          return;
        }
        // 產生表頭
        const headers = Object.keys(data[0]);
        let html = '<tr>';
        headers.forEach(h => html += `<th>${h}</th>`);
        html += '</tr>';

        // 產生內容列
        data.forEach(row => {
          html += '<tr>';
          headers.forEach(h => {
            html += `<td>${row[h]}</td>`;
          });
          html += '</tr>';
        });

        table.innerHTML = html;
      }

      Tabletop.init({
        key: publicSpreadsheetUrl,
        simpleSheet: true,
        callback: showInfo,
      });
    }
  </script>
</body>
</html>
